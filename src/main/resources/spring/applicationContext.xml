<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:jms="http://www.springframework.org/schema/jms" xmlns:jee="http://www.springframework.org/schema/jee"
	xmlns:context="http://www.springframework.org/schema/context"
	xmlns:camel="http://camel.apache.org/schema/spring" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:osgi="http://www.springframework.org/schema/osgi" xmlns:amq="http://activemq.apache.org/schema/core"
	xmlns:tx="http://www.springframework.org/schema/tx"
	xsi:schemaLocation=" 
            http://www.springframework.org/schema/beans
            http://www.springframework.org/schema/beans/spring-beans.xsd
            http://www.springframework.org/schema/context 
    		http://www.springframework.org/schema/context/spring-context-3.0.xsd
            http://www.springframework.org/schema/osgi
        	http://www.springframework.org/schema/osgi/spring-osgi.xsd
            http://www.springframework.org/schema/tx
            http://www.springframework.org/schema/tx/spring-tx.xsd
            http://www.springframework.org/schema/jms
        	http://www.springframework.org/schema/jms/spring-jms-3.0.xsd
      	 	http://www.springframework.org/schema/jee
      	 	http://www.springframework.org/schema/jee/spring-jee-3.0.xsd
      	  	http://activemq.apache.org/schema/core 
       		http://activemq.apache.org/schema/core/activemq-core.xsd
       		http://camel.apache.org/schema/spring 
		  	http://camel.apache.org/schema/spring/camel-spring.xsd
       		">
	<description>Spring3.1.3</description>
	<!--	<context:property-placeholder location="classpath:/spring/*.properties" />
	<context:spring-configured />-->
	<context:component-scan base-package="com.activemq">
		<!--<context:exclude-filter expression=".*_Roo_.*"
			type="regex" />
		<context:exclude-filter expression="org.springframework.stereotype.Controller"
			type="annotation" /> -->
	</context:component-scan>
	
	
	<!-- 配置ConnectionFactory -->
	<bean id="connectionFactory" class="org.apache.activemq.pool.PooledConnectionFactory"
		destroy-method="stop">
		<property name="connectionFactory" ref="innerConnectionFactory" />
	</bean>
	<bean id="innerConnectionFactory" class="org.apache.activemq.ActiveMQConnectionFactory">
		<property name="brokerURL" value="tcp://localhost:61616" />
	</bean>
	<!-- 配置一个Destination作为默认投递目标 -->
	<bean id="defaultDestination" class="org.apache.activemq.command.ActiveMQQueue">
		<constructor-arg index="0" value="activemqtest" />
	</bean>
	<!-- 核心JmsTemplate -->
	<bean id="jmsTemplate" class="org.springframework.jms.core.JmsTemplate">
		<property name="connectionFactory" ref="connectionFactory" />
		<property name="defaultDestination" ref="defaultDestination" />
	</bean>
	<!-- JMS事务 -->
	<bean id="jmsTransactionManager"
		class="org.springframework.jms.connection.JmsTransactionManager">
		<property name="connectionFactory" ref="connectionFactory" />
	</bean>
	<tx:annotation-driven transaction-manager="jmsTransactionManager" />
	<!--编写消息驱动Bean,两个接口实现一个即可 -->
	<!-- 配置消息驱动Bean -->
	<jms:listener-container connection-factory="connectionFactory">
		<jms:listener destination="activemqtest" ref="defaultMessageHandler" />
	</jms:listener-container>

	<!-- (一)配置ConnectionFactory -->
</beans>